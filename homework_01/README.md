# Homework 01-å®ç°Sufe::Array



## ğŸ“œDemands

- å®ç°`std::array`çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ŒåŒ…æ‹¬
    - For-eachéå†
    - **æé«˜**ï¼šè¿›ä¸€æ­¥äº†è§£è®¾è®¡æ¨¡å¼**Iterator**
- åŸºäºé™„ä»¶*array.starter.zip*ï¼Œå®ç°è¯¾ä»¶ä¸­çš„`Sufe::Array`æ¨¡æ¿ç±»åŠŸèƒ½ï¼Œç”¨ç»™å®šçš„*main.cpp*é€šè¿‡æµ‹è¯•
    - ä¸åŒåˆå§‹åŒ–æ–¹å¼
    - è°ƒç”¨Size()ï¼Œ[]ï¼ŒAt()ï¼Œ<< è¾“å‡ºåˆ°å±å¹•
    - for-eachéå†
    - è°ƒç”¨Sort()ï¼Œå¯¹æ•°ç»„è‡ªèº«æ’åº

## ğŸ“Efforts

### Makefile

å‹ç¼©åŒ…ä¸­ç»™åˆ°çš„makefileåœ¨vscodeä¸­è¿›è¡Œç¼–è¯‘é‡åˆ°çš„é—®é¢˜æ˜¯:

- ä¸èƒ½ä¸»åŠ¨åˆ›å»ºbuildæ–‡ä»¶å¤¹,ä¼šæŠ¥é”™å¦‚ä¸‹:

    ```
    process_begin: CreateProcess(NULL, mkdir build, ...) failed.
    make (e=2): ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚
    make: *** [Makefile:24: build] Error 2
    ```

- åœ¨äººå·¥åˆ›å»ºbuildæ–‡ä»¶å,èƒ½æ­£å¸¸ç”Ÿæˆ*main.o*å’Œ*runme.exe*æ–‡ä»¶,ä½†æ˜¯vscodeä»ç„¶æŠ¥é”™ç”Ÿæˆå¤±è´¥,æ— æ³•è¿›å…¥åˆ°è°ƒè¯•ç•Œé¢.

**è§£å†³æ–¹æ¡ˆ:**

æœ€åç»è¿‡ä¸€ç•ªæœç´¢å’Œå°è¯•ä¹‹å,å‘ç°å¯ä»¥åœ¨æ¯ä¸ªå‘½ä»¤å‰æ·»åŠ `cmd /C`,å¼ºåˆ¶æŒ‡å®šä½¿ç”¨cmdè€Œä¸æ˜¯é»˜è®¤çš„powershellæ¥è·‘ç¼–è¯‘.ç°åœ¨ç¡®å®ä¸ä¼šå†æœ‰æŠ¥é”™äº†,ä¸è¿‡è¿™ä¹ˆå¹²çš„åæœå¤§æ¦‚æ˜¯makefileä¸èƒ½è·¨å¹³å°äº†(æ¯•ç«ŸLinuxå’Œmacoså¹¶æ²¡æœ‰cmd).

### Iterator(è¿­ä»£å™¨)

- **è¿­ä»£å™¨æ¨¡å¼**è®©ç”¨æˆ·åœ¨ä¸çŸ¥é“å†…éƒ¨å®ç°çš„åŸºç¡€ä¸Š,å¯¹å®¹å™¨å†…æ¯ä¸ªæ•°æ®å…ƒç´ è¿›è¡Œéå†
- æœ¬è´¨ä¸Šè¿˜æ˜¯æŒ‡é’ˆ

```c++
class Iterator
{
private:
    _TYPE *m_ptr;
public:
    Iterator(_TYPE *elem):m_ptr(elem){}
    _TYPE &operator*(){return *m_ptr;}
    void operator++(){++m_ptr;}
    bool operator!=(const Iterator &rhs){return m_ptr!=rhs.m_ptr;}
};

Iterator begin(){return Iterator(m_data);}
Iterator end(){return Iterator(m_data+_SIZE);}
```

### åˆå§‹åŒ–åˆ—è¡¨çš„æ„é€ å‡½æ•°

ç¼–è¯‘å™¨å¯¹{,â€¦â€¦}è‡ªåŠ¨ç”Ÿæˆ `std::initializer_list`

```c++
Array(std::initializer_list<_TYPE> list):m_data{0}
{
    assert(list.size()<=_SIZE);
    std::copy(list.begin(),list.end(),m_data);
}
```

#### assertè¯­å¥

```
void assert(int expression);
```

assertå®çš„åŸå‹å®šä¹‰åœ¨<assert.h>ä¸­ï¼Œå…¶ä½œç”¨æ˜¯å…ˆè®¡ç®—è¡¨è¾¾å¼expressionçš„å€¼ä¸ºå‡(å³ä¸º0),é‚£ä¹ˆå®ƒå°±å…ˆå‘stderræ‰“å°ä¸€æ¡å‡ºé”™ä¿¡æ¯ï¼Œç„¶åé€šè¿‡æ¡ç”¨abortæ¥ç»ˆæ­¢ç¨‹åºï¼›

ä½¿ç”¨assertçš„ç¼ºç‚¹æ˜¯ï¼Œé¢‘ç¹çš„è°ƒç”¨ä¼šæå¤§çš„å½±å“ç¨‹åºçš„æ€§èƒ½ï¼Œå¢åŠ é¢å¤–çš„å¼€é”€ã€‚

åœ¨è¿™ä¸ªæ„é€ å‡½æ•°ä¸­,ä½¿ç”¨assertè¯­å¥æ¥é˜²æ­¢åˆå§‹åŒ–çš„åˆ—è¡¨å®¹é‡å¤§äºä¹‹å‰åˆå§‹è®¾ç½®çš„æ•°ç»„size.

### æ’åº

æœ€å¼€å§‹çš„æƒ³æ³•æ˜¯ç›´æ¥å¼€æ‘†ç›´æ¥ç”¨`std::sort()`æ¥å®Œæˆæ’åº,ä½†æ˜¯åœ¨ç”Ÿæˆæ—¶å‡ºç°äº†æŠ¥é”™,è¯´æ˜ç¼–è¯‘å™¨å¹¶ä¸æ”¯æŒè¿™ä¹ˆå¹².äºæ˜¯æœ€ç»ˆè¿˜æ˜¯å†³å®šå°è¯•ä¸€ä¸‹æ‰‹å†™å¿«é€Ÿæ’åºæ¥è¿›è¡Œå®ç°.

#### å¿«é€Ÿæ’åº

å¿«é€Ÿæ’åºï¼Œåˆç§°åˆ’åˆ†äº¤æ¢æ’åºï¼ˆpartition-exchange sortï¼‰

**1.åŸºæœ¬æ€æƒ³**

é€šè¿‡ä¸€è¶Ÿæ’åºå°†å¾…æ’è®°å½•åˆ†éš”æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†è®°å½•çš„å…³é”®å­—å‡æ¯”å¦ä¸€éƒ¨åˆ†çš„å…³é”®å­—å°ï¼Œåˆ™å¯åˆ†åˆ«å¯¹è¿™ä¸¤éƒ¨åˆ†è®°å½•ç»§ç»­è¿›è¡Œæ’åºï¼Œä»¥è¾¾åˆ°æ•´ä¸ªåºåˆ—æœ‰åºã€‚

**2. å®ç°é€»è¾‘**

å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»æ³•ï¼ˆDivide and conquerï¼‰ç­–ç•¥æ¥æŠŠä¸€ä¸ªåºåˆ—ï¼ˆlistï¼‰åˆ†ä¸ºä¸¤ä¸ªå­åºåˆ—ï¼ˆsub-listsï¼‰ã€‚

> â‘  ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º â€œåŸºå‡†â€ï¼ˆpivotï¼‰ï¼Œ
> â‘¡ é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œã€‚
> â‘¢ é€’å½’åœ°ï¼ˆrecursiveï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºã€‚

é€’å½’åˆ°æœ€åº•éƒ¨æ—¶ï¼Œæ•°åˆ—çš„å¤§å°æ˜¯é›¶æˆ–ä¸€ï¼Œä¹Ÿå°±æ˜¯å·²ç»æ’åºå¥½äº†ã€‚è¿™ä¸ªç®—æ³•ä¸€å®šä¼šç»“æŸï¼Œå› ä¸ºåœ¨æ¯æ¬¡çš„è¿­ä»£ï¼ˆiterationï¼‰ä¸­ï¼Œå®ƒè‡³å°‘ä¼šæŠŠä¸€ä¸ªå…ƒç´ æ‘†åˆ°å®ƒæœ€åçš„ä½ç½®å»ã€‚

#### å®ç°

å¿«é€Ÿæ’åºçš„å®ç°æ–¹æ³•æœ‰ä¸¤ç§,ä¸€ç§æ˜¯ä½¿ç”¨é€’å½’æ³•,ä¸€ç§æ˜¯ä½¿ç”¨è¿­ä»£æ³•.å…¶ä¼˜ç‚¹å’Œç¼ºç‚¹åˆ†åˆ«è®°å½•åœ¨ä¸‹è¡¨ä¸­:

|      | é€’å½’æ³•                                   | è¿­ä»£æ³•                                |
| ---- | ---------------------------------------- | ------------------------------------- |
| ä¼˜ç‚¹ | ä»£ç é‡è¾ƒå°‘,å¯è¯»æ€§è¾ƒé«˜                    | åœ¨åŒä¸€æ ˆå¸§ä¸­ä¸æ–­è¿­ä»£,ä¸ä¼šäº§ç”Ÿé¢å¤–å¼€é”€ |
| ç¼ºç‚¹ | å‡½æ•°è°ƒç”¨å’Œå †æ ˆå ç”¨å¯¹æ—¶é—´å’Œç©ºé—´çš„å¼€é”€è¾ƒå¤§ | ä»£ç é‡æ›´å¤§,å½±å“å¯è¯»æ€§                 |

åœ¨å°è¯•ä¸¤ç§æ–¹æ³•ä¹‹å,æœ€ç»ˆè¿˜æ˜¯é€‰æ‹©äº†è¿­ä»£æ³•.é€’å½’æ³•é‡åˆ°çš„å…·ä½“é—®é¢˜ä¼šåœ¨**ğŸª²Problems**ç« èŠ‚è¿›è¡Œè¯¦ç»†é˜è¿°.

è¿­ä»£æ³•çš„å®ç°å¦‚ä¸‹:

```c++
// ä½œä¸ºArrayç±»çš„ç§æœ‰æˆå‘˜ä»¥ä¾¿è¾…åŠ©å®ç°å¿«é€Ÿæ’åºçš„ç»“æ„ä½“,è®°å½•ä¸€ä¸ªæ•°æ®èŒƒå›´çš„å¼€å§‹ä¸ç»“æŸ
struct Range
{
    int start,end;
    Range(int s=0,int e=0){start=s,end=e;}
};

// å…¬æœ‰æ–¹æ³•,å®ç°æ’åºåŠŸèƒ½
void Sort()
{
    Range r[_SIZE]; int p=0;
    // r[]æ¨¡æ‹Ÿå †æ ˆ,pä¸ºæ•°é‡,r[p++]ä¸ºpush,r[--p]ä¸ºpopä¸”å–å¾—å…ƒç´ 
    r[p++]=Range(0,_SIZE-1);

    // å½“æ‰€æœ‰æ’åºå®Œæˆå,åœ¨å¾ªç¯ä½“æ£€éªŒpæ—¶æ°å¥½p=0,ä¸å†è¿›å…¥å¾ªç¯
    while(p)
    {
        Range range=r[--p];
        if(range.start>=range.end) continue;
        _TYPE pivot=m_data[range.end];  // åŸºå‡†æ•°ç»Ÿä¸€ä½¿ç”¨æœ«å°¾æ•°
        int left=range.start,right=range.end-1;

        while(left<right)
        {
            while(m_data[left]<pivot && left<right) left++;
            while(m_data[right]>=pivot && left<right) right--;
            std::swap(m_data[left],m_data[right]);
        }
        if(m_data[left]>=m_data[range.end])
            std::swap(m_data[left],m_data[range.end]);
        else left++;

        r[p++]=Range(range.start,left-1);
        r[p++]=Range(left+1,range.end);
    }
}
```

### è¿ç®—ç¬¦é‡è½½

```c++
// TODO: 4) å®ç°At()å’Œ[]è¿ç®—ç¬¦é‡è½½
_TYPE &At(int idx)
{
    assert(idx>=0 && idx<_SIZE);
    return m_data[idx];
}
_TYPE &operator[](int idx){return m_data[idx];}
const _TYPE &operator[](int index) const{return m_data[index];}

// TODO: 5) å®ç°<<è¿ç®—ç¬¦é‡è½½
friend std::ostream &operator<<(std::ostream &out, const Array &arr)
{
    for(size_t i=0;i<_SIZE;i++)
    {
    	out<<arr[i]<<" ";
    }
    return out;
}
```

## ğŸ–¨ï¸Test Results

```
arr_x has size 4
arr_4 has size 4
arr_7 has size 7
initial elements of arr_7 are 8 4 6 5 7 9 3
sorted elements of arr_7 are 3 4 5 6 7 8 9
```

## ğŸª²Problems

### Makefile

å…³äºmakefileé™¤äº†ä¸Šè¿°åœ¨**ğŸ“Efforts**ç« èŠ‚ä¸­æåˆ°çš„å¼ºåˆ¶ä»¥cmdè¿è¡Œå¯èƒ½ä¼šå‡ºç°çš„å…¼å®¹æ€§é—®é¢˜,è¿˜å­˜åœ¨æœ‰è¿™äº›é—®é¢˜:

- vscode&C++ extensionç¯å¢ƒä¸‹,å¯ä»¥æ­£å¸¸ç”Ÿæˆ(å’Œç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œmakeå‘½ä»¤ä¸€æ ·),ä½†æ˜¯æ— æ³•é€šè¿‡vscodeè¿›å…¥åˆ°è°ƒè¯•ç•Œé¢;
- å¯ä»¥é€šè¿‡Makefile Toolsè¿™ä¸ªæ’ä»¶æ­£å¸¸è¿›å…¥åˆ°è°ƒè¯•,ä½†æ˜¯å¦‚æœç›®å½•ä¸‹æ²¡æœ‰buildè¿™ä¸ªæ–‡ä»¶å¤¹çš„è¯,ä¼šç”Ÿæˆå¤±è´¥;
- Makefile Toolsè¿™ä¸ªæ’ä»¶å¶å°”ä¼šå‡ºç°ç”Ÿæˆçš„exeä»ç„¶æ˜¯ä¿®æ”¹å‰çš„ä¸Šä¸€ç‰ˆä»£ç çš„æƒ…å†µ(æ²¡æœ‰å½»åº•è¦†ç›–ä¸Šä¸€ç‰ˆ)

### å¿«é€Ÿæ’åº

ä¸€å¼€å§‹é‡‡ç”¨çš„æ˜¯é€’å½’æ³•æ¥å®ç°å¿«æ’,ä»£ç å¦‚ä¸‹:

```c++
void quick_sort(int start,int end)
{
    if(start>=end) return;
    _TYPE pivot=m_data[end];
    int left=start,right=end-1;

    while(left<right)
    {
        while(m_data[left]<pivot && left<right) left++;
        while(m_data[right]>=pivot && left<right) right--;
        std::swap(m_data[left],m_data[right]);
    }
    if(m_data[left]>=m_data[end])
        std::swap(m_data[left],m_data[end]);
    else left++;

    quick_sort(start,left-1);
    quick_sort(left+1,end);
}

void Sort(){quick_sort(0,_SIZE-1);}
```

ä½†æ˜¯ä¸»è¦å‘ç°äº†ä¸¤ä¸ªé—®é¢˜:

- `_TYPE pivot=m_data[end];`è¿™ä¸€å¥å¹¶æ²¡èƒ½æˆåŠŸèµ‹å€¼,åœ¨è°ƒè¯•æ—¶å‘ç°`pivot`çš„å€¼ä¸€ç›´ä¸º0;
- å—ä¸Šä¸€æ¡å½±å“,æ’åºåçš„ç»“æœä¸º0 3 4 5 6 7 8,å³9å˜æˆäº†0;

æ€€ç–‘æ˜¯å­˜åœ¨æ½œåœ¨çš„æ•°ç»„è¶Šç•Œé—®é¢˜,ä½†æ˜¯ç¼–è¯‘å™¨å¹¶æ²¡æœ‰ç»™å‡ºæŠ¥é”™.äºæ˜¯åœ¨æœ€åç»¼åˆæƒè¡¡ä¸‹,è¿˜æ˜¯é€‰æ‹©äº†è¿­ä»£æ³•æ¥è¿›è¡Œå®ç°.

## ğŸ““Logs

- 2023.9.19 å¼€å·¥,TODOé™¤äº†æ’åºéƒ¨åˆ†å…¨éƒ¨å®Œæˆ;
- 2023.9.20 TODOå…¨éƒ¨å®Œæˆ,ç¨‹åºæµ‹è¯•å®Œæˆ,æ–‡æ¡£å†™ä½œå®Œæˆ,ä½œä¸šä¸Šäº¤å®Œæˆ;

